"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[10],{61010:function(e,t,r){r.r(t),r.d(t,{default:function(){return J}});var s=r(85893),a=r(67294),n=r(3576),i=r(79691),c=r(1686),d=r(30723),l=r(9019),o=r(78757),x=r(45578),m=r.n(x),u=r(63750),h=r(79352),f=r(11163),p=r(30381),g=r.n(p),y=r(18426),b=r(6218),j=r(61751),v=r(46249),N=r(91131),w=r(43101),k=r(82130),C=r(5506),Z=r(37328),F=r(59856),S=r(40782),U=r(74855),D=r(96787),O=r(85528),_=r(20567),E=r(24796),L=r(73210),M=r(44156);function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],s=!0,a=!1,n=void 0;try{for(var i,c=e[Symbol.iterator]();!(s=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(d){a=!0,n=d}finally{try{s||null==c.return||c.return()}finally{if(a)throw n}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var A=function(e){var t=e.conversations,r=e.unreadMessages,n=T((0,N.KO)(w.D0),2)[1],i=(0,b.ff)().data,c=(0,j.bj)().mutate,d=(0,f.useRouter)(),l=(0,v.LU)().data,o=function(e){n(e),d.push("/d/chat")},x=function(e){if("https://didcomm.org/webrtc/1.0/sdp"===(null===e||void 0===e?void 0:e.data.type))return"Sent you an invite to connect.";if("file-transfer-done"===(null===e||void 0===e?void 0:e.data.type))return"File transfer.";var t,r;if(!function(e){try{JSON.parse(e)}catch(t){return!1}return!0}(null===e||void 0===e?void 0:e.data.body.content))return"".concat(null===(t=null===e||void 0===e?void 0:e.data.body.content)||void 0===t?void 0:t.slice(0,50)," ").concat((null===(r=null===e||void 0===e?void 0:e.data.body.content)||void 0===r?void 0:r.length)>50?"...":"");var s=JSON.parse(null===e||void 0===e?void 0:e.data.body.content),a=s.filename,n=s.dataUri;return a&&n?"File transfer.":void 0};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,s.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,s.jsx)("span",{className:"lg:pl-2",children:"Conversations"})}),(0,s.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Participants"}),(0,s.jsx)("th",{className:"hidden md:table-cell px-6 py-3 border-b border-gray-200 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Latest"}),(0,s.jsx)("th",{className:"pr-6 py-3 border-b border-gray-200 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:t&&t.map((function(e,t){var n,d=e.groupId,m=e.messages;return(0,s.jsxs)("tr",{className:"".concat(r[d]>0?"bg-white":"bg-gray-100"),children:[(0,s.jsx)("td",{onClick:function(){return o(d)},className:"px-6 py-3 max-w-0 w-full whitespace-nowrap text-sm font-medium text-gray-900",children:(0,s.jsx)("div",{className:"flex items-center space-x-3 lg:pl-2",children:(0,s.jsxs)("div",{className:"truncate hover:text-gray-600 flex items-center",children:[(0,E.Lz)({message:m.slice(-1)[0],contacts:null===i||void 0===i?void 0:i.data.contacts,myDid:l}).map((function(e,t){return(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)(O.Z,{contact:e,className:"h-10 w-10"}),(0,s.jsx)("span",{className:"pl-2 text-gray-900 text-md font-semibold pr-5",children:null===e||void 0===e?void 0:e.name})]},t)})),r[d]>0&&(0,s.jsxs)("div",{className:"flex items-center space-x-4 pr-4",children:[(0,s.jsx)("div",{className:"bg-primary flex-shrink-0 w-2.5 h-2.5 rounded-full","aria-hidden":"true"}),(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800",children:r[d]})]}),(0,s.jsx)("span",{className:"".concat(r[d]>0?"font-semibold":"font-normal"),children:x(m.slice(-1)[0])})]})})}),(0,s.jsx)("td",{className:"px-6 py-3 text-sm text-gray-500 font-medium",children:(0,s.jsx)("div",{className:"flex items-center space-x-2 justify-center",children:(0,s.jsx)("div",{className:"flex flex-shrink-0 -space-x-1 items-center",children:(0,E.Lz)({message:m.slice(-1)[0],contacts:null===i||void 0===i?void 0:i.data.contacts,myDid:l}).map((function(e,t){return(0,s.jsx)(a.Fragment,{children:(0,s.jsx)(O.Z,{contact:e,className:"h-6 w-6"},t)},t)}))})})}),(0,s.jsx)("td",{className:"hidden md:table-cell px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-right",children:g().unix(null===(n=m.slice(-1)[0])||void 0===n?void 0:n.data.created_time).fromNow()}),(0,s.jsx)("td",{className:"px-6 py-3 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:function(){return o(d)},children:(0,s.jsx)("div",{className:"text-indigo-800 hover:text-indigo-900",children:"View"})}),(0,s.jsx)("button",{onClick:function(){return(0,Z.SJ)({groupId:d,deleteGroupMessage:c})},children:(0,s.jsx)("div",{className:"text-red-800 hover:text-red-900",children:"Delete"})})]})})]},t)}))})]})})},I=function(e){var t=e.notifications,r=(0,b.ff)().data,n=(0,v.LU)().data;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,s.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,s.jsx)("span",{className:"lg:pl-2",children:"Notifications"})}),(0,s.jsx)("th",{className:"hidden md:table-cell px-6 py-3 border-b border-gray-200 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),(0,s.jsx)("th",{className:"pr-6 py-3 border-b border-gray-200 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:null===t||void 0===t?void 0:t.map((function(e,t){return(0,s.jsxs)("tr",{className:"".concat((0,Z.qP)(e.data.created_time)?"bg-white":"bg-gray-100"," "),children:[(0,s.jsx)("td",{className:"px-6 py-3 max-w-0 w-full whitespace-nowrap text-sm font-medium text-gray-900",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3 lg:pl-2",children:[(0,s.jsx)("div",{className:"flex flex-shrink-0 -space-x-1 items-center",children:(0,E.Lz)({message:e,contacts:null===r||void 0===r?void 0:r.data.contacts,myDid:n}).map((function(e,t){return(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)(O.Z,{contact:e,className:"h-10 w-10"}),(0,s.jsx)("span",{className:"pl-2 text-gray-900 text-md font-semibold pr-5",children:null===e||void 0===e?void 0:e.name})]},t)}))}),(0,s.jsx)("div",{href:"#",className:"truncate hover:text-gray-600",children:(0,s.jsx)("span",{className:"".concat((0,Z.qP)(e.data.created_time)?"font-bold":"font-normal"),children:(0,s.jsx)("span",{className:"text-gray-500 font-normal",children:"".concat((0,E.Er)({shortFormDid:(0,_.Ho)(e.data.from),contacts:r.data.contacts}).name," invited you to connect")})})})]})}),(0,s.jsx)("td",{className:"hidden md:table-cell px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-right",children:g().unix(e.data.created_time).fromNow()}),(0,s.jsx)("td",{className:"px-6 py-3 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsx)(s.Fragment,{children:(0,Z.qP)(e.data.created_time)?(0,s.jsx)("button",{onClick:function(){return(0,F.WV)({detail:{message:e.data.body.content,knownContact:(0,E.Er)({shortFormDid:(0,_.Ho)(e.data.from),contacts:r.data.contacts}),sourceType:"didcomm"}})},children:(0,s.jsx)("div",{className:"text-indigo-800 hover:text-indigo-900 pr-2 ",children:"Show"})}):(0,s.jsx)("div",{className:"text-gray-600",children:"Expired"})})})]},t)}))})]})})},P=function(e){var t=e.peers;e.router;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,s.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,s.jsx)("span",{className:"lg:pl-2",children:"Connected Users"})}),(0,s.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"DID"}),(0,s.jsx)("th",{className:"pr-6 py-3 border-b border-gray-200 bg-gray-50 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:t.map((function(e,t){return(0,s.jsxs)("tr",{className:"".concat("bg-white"),children:[(0,s.jsx)("td",{className:"px-6 py-3 max-w-0 w-full whitespace-nowrap text-sm font-medium text-gray-900",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3 lg:pl-2",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-3 h-3 rounded-full flex items-center justify-center ".concat("border-2 border-green-400"),"aria-hidden":"true",children:(0,s.jsx)("div",{className:"flex-shrink-0 w-2 h-2 rounded-full bg-green-400 border-2 border-green-400 ","aria-hidden":"true"})}),(0,s.jsx)(O.Z,{contact:e.metadata.contact,className:"h-6 w-6"},t),(0,s.jsx)("div",{className:"truncate hover:text-gray-600",children:(0,s.jsx)("span",{children:e.metadata.contact?e.metadata.contact.name:"Unknown User"})})]})}),(0,s.jsx)("td",{className:"px-6 py-3 text-sm text-gray-500 font-medium",children:(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)("div",{className:"flex flex-shrink-0 -space-x-1",children:e.metadata.dest})})}),(0,s.jsx)("td",{className:"hidden md:table-cell px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-right",children:"Online"}),(0,s.jsxs)("td",{className:"px-6 py-3 whitespace-nowrap text-right text-sm font-medium",children:[(0,s.jsx)("button",{type:"button",className:"inline-flex items-center p-1",children:(0,s.jsx)(i.Z,{className:"h-5 w-5 text-indigo-800 hover:text-primary-hover","aria-hidden":"true"})}),(0,s.jsx)("button",{type:"button",className:"inline-flex items-center p-1",children:(0,s.jsx)(c.Z,{className:"h-5 w-5 text-indigo-800 hover:text-primary-hover","aria-hidden":"true"})}),(0,s.jsx)("button",{type:"button",className:"inline-flex items-center p-1",children:(0,s.jsx)(u.mly,{className:"h-5 w-5 text-indigo-800 hover:text-primary-hover","aria-hidden":"true"})}),(0,s.jsx)("button",{type:"button",className:"inline-flex items-center p-1",onClick:function(){return e.peer.destroy()},children:(0,s.jsx)(C.Z,{className:"h-5 w-5 text-indigo-800 hover:text-primary-hover","aria-hidden":"true"})})]})]},t)}))})]})})},q=function(e){var t=e.title,r=e.subtitle,a=e.notificationCount,n=e.setCurrentTable,i=e.icon;return(0,s.jsxs)("li",{className:"relative col-span-1 flex shadow-sm rounded-md",onClick:function(){return n(t)},children:[(0,s.jsxs)("div",{className:"bg-primary flex-shrink-0 flex items-center justify-center w-16 text-white text-sm font-medium rounded-l-md px-4",children:[(0,s.jsx)("div",{className:"".concat(a>0?"bg-green-500":"bg-opacity-100"," flex-shrink-0 w-3 h-3 rounded-full absolute top-0 right-0"),"aria-hidden":"true"}),i]}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-between border-t border-r border-b border-gray-200 bg-white rounded-r-md truncate",children:(0,s.jsxs)("div",{className:"flex-1 px-4 py-2 text-sm truncate",children:[(0,s.jsx)("div",{href:"#",className:"text-gray-900 font-medium hover:text-gray-600",children:t}),(0,s.jsxs)("p",{className:"text-gray-500",children:[a," ",r]})]})})]},t)};function J(){var e=(0,a.useState)("Messages"),t=e[0],r=e[1],x=(0,a.useState)(!1),p=x[0],g=x[1],C=(0,a.useState)({}),Z=C[0],F=C[1],O=(0,a.useState)([]),_=O[0],E=O[1],J=(0,a.useState)([]),K=J[0],R=J[1],z=(0,f.useRouter)(),H=T((0,N.KO)(w.Lu),1)[0],V=T((0,N.KO)(k.R3),1)[0],G=T((0,N.KO)(D.UX),1)[0],Q=(0,v.LU)().data,W=(0,b.JA)().data,X=(0,b.ff)().data,B=(0,L.p)().data,Y=(0,j.mA)({contacts:null===X||void 0===X?void 0:X.data.contacts,myDid:Q,blocklist:W,settings:B}).data,$=(0,M.r)().data;(0,a.useEffect)((function(){if(V){var e=V.filter((function(e){return e.peer._connected}));R(m()(e,"metadata.dest"))}}),[V]),(0,a.useEffect)((function(){var e=0,t={total:0};if(Y){var r=Y.conversations,s=Y.notifications;r&&r.forEach((function(e){var r=e.messages.filter((function(e){return-1===H.indexOf(e.id)})).length;t[e.groupId]=r,t.total+=r})),s&&(e=s.filter((function(e){return-1===H.indexOf(e.id)})).length)}F(t),E(e)}),[H,Y]);return(0,s.jsx)(n.Z,{currentPage:"Dashboard",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{open:p,setOpen:g,selectedContact:null}),(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("main",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"px-4 mt-6 sm:px-6 lg:px-8",children:[(0,s.jsx)("h2",{className:"text-gray-500 text-xs font-medium uppercase tracking-wide",children:"Quick Actions"}),(0,s.jsxs)("ul",{role:"list",className:"grid grid-cols-1 gap-4 sm:gap-6 sm:grid-cols-2 xl:grid-cols-4 mt-3 ",children:[(0,s.jsx)("li",{children:(0,s.jsxs)("div",{className:"flex-1 flex items-center pt-2 truncate space-x-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center pr-2",children:[(0,s.jsx)("button",{type:"button",onClick:function(){return z.push("/d/meeting")},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-primary hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:(0,s.jsx)(i.Z,{className:"h-5 w-5","aria-hidden":"true"})}),(0,s.jsx)("p",{className:"text-gray-900 font-medium hover:text-gray-600 text-sm pt-1",children:"Meet"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("button",{type:"button",onClick:function(){return z.push("/d/chat")},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-primary hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:(0,s.jsx)(d.Z,{className:"h-5 w-5","aria-hidden":"true"})}),(0,s.jsx)("p",{className:"text-gray-900 font-medium hover:text-gray-600 text-sm pt-1",children:"Message"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("button",{type:"button",onClick:function(){(null===$||void 0===$?void 0:$.data.lightningConfig.listening)?g(!0):S.Am.info("Connect to a lightning node to use this action.")},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-primary hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:(0,s.jsx)(u.mly,{className:"h-5 w-5","aria-hidden":"true"})}),(0,s.jsx)("p",{className:"text-gray-900 font-medium hover:text-gray-600 text-sm pt-1",children:"Lightning"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)(U.CopyToClipboard,{text:G,onCopy:function(){return S.Am.info("Copied to clipboard! Share this document!")},children:(0,s.jsx)("button",{type:"button",className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-primary hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:(0,s.jsx)(h.FqR,{className:"h-5 w-5","aria-hidden":"true"})})}),(0,s.jsx)("p",{className:"text-gray-900 font-medium hover:text-gray-600 text-sm pt-1",children:"Share"})]})]})}),(0,s.jsx)(q,{title:"Messages",subtitle:"Unread Messages",notificationCount:Z.total,setCurrentTable:r,icon:(0,s.jsx)(c.Z,{})}),(0,s.jsx)(q,{title:"Notifications",subtitle:"New Notifications",notificationCount:_,setCurrentTable:r,icon:(0,s.jsx)(l.Z,{})}),(0,s.jsx)(q,{title:"Connected Users",subtitle:"Connected Users",notificationCount:K.length,setCurrentTable:r,icon:(0,s.jsx)(o.Z,{})})]})]}),(0,s.jsx)("div",{className:"mt-8 ",children:(0,s.jsxs)("div",{className:"align-middle inline-block min-w-full border-b border-gray-200",children:["Messages"===t&&(0,s.jsx)(A,{unreadMessages:Z,conversations:null===Y||void 0===Y?void 0:Y.conversations}),"Notifications"===t&&(0,s.jsx)(I,{notifications:null===Y||void 0===Y?void 0:Y.notifications.slice(-20)}),"Connected Users"===t&&(0,s.jsx)(P,{peers:K,router:z})]})})]})})]})})}}}]);
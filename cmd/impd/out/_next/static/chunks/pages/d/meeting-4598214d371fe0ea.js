(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[783],{7309:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/d/meeting",function(){return n(45392)}])},51079:function(e,t,n){"use strict";var r=n(85893),i=n(67294),s=n(42633);t.Z=function(e){var t=e.setFile,n=e.disabled,a=(0,i.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{type:"button",onClick:function(e){a.current.click()},children:(0,r.jsx)(s.Z,{className:"h-10 w-10 text-gray-600 font-light","aria-hidden":"true"})}),(0,r.jsx)("input",{type:"file",ref:a,onChange:function(e){t(e.target.files[0]),a.current.value=null},style:{display:"none"},disabled:n})]})}},45192:function(e,t,n){"use strict";var r=n(85893),i=(n(67294),n(68163)),s=n(86588),a=n(13902),o=n(40782),l=n(47941);t.Z=function(e){var t,n=e.fileInput,c=e.setFileInput,d=e.progress,u=function(){return c()};return(0,r.jsxs)("div",{children:[" ",(0,r.jsx)("div",{className:"my-3 max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-0 flex-1 flex justify-between",children:(0,r.jsxs)("p",{className:"w-0 flex-1 text-sm font-medium text-gray-900",children:[n.name," ",(0,r.jsxs)("span",{className:"font-light text-gray-500",children:["(",(0,l.G)(n.size),")"]})]})}),(0,r.jsx)("div",{className:"ml-4 flex-shrink-0 flex",children:t>0?(0,r.jsx)(s.gy,{height:"20",width:"20",color:"#312e81",ariaLabel:"loading"}):n.isError?(0,r.jsx)(a.Z,{onClick:function(){o.Am.error("Unable to upload file. Please try again."),u(file.id)},className:"h-6 w-6 text-red-600","aria-hidden":"true"}):(0,r.jsxs)("button",{type:"button",className:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:function(){return u()},children:[(0,r.jsx)("span",{className:"sr-only",children:"Close"}),(0,r.jsx)(i.Z,{className:"h-5 w-5","aria-hidden":"true"})]})})]}),d>0&&(0,r.jsx)("div",{className:"flex items-center pt-2",children:(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full dark:bg-gray-700 mx-20",children:(0,r.jsxs)("div",{className:"bg-blue-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full",style:{width:"".concat(Math.floor(d),"%")},children:[" ",Math.floor(d),"%"]})})})]})})]})}},59758:function(e,t,n){"use strict";var r=n(85893),i=(n(67294),n(42833)),s=n(63090),a=n(93162),o=n(47941);t.Z=function(e){var t=e.message,n=e.myDid,l=e.fileObj;return(0,r.jsx)("div",{className:"bg-white px-4 py-5 border-2 border-gray-200 rounded-lg sm:px-6 mt-6",children:(0,r.jsxs)("div",{className:"-ml-4 -mt-4 flex justify-between items-center flex-wrap sm:flex-nowrap",children:[(0,r.jsx)("div",{className:"ml-4 mt-4",children:(0,r.jsx)("div",{className:"flex space-x-2 items-center",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h3",{className:"text-md leading-6 break-all font-medium text-gray-900",children:t.data?t.data.name:"No File Name"}),(0,r.jsx)("p",{className:"mt-1 text-sm font-light text-gray-500",children:t.data&&"(".concat((0,o.G)(t.data.size),")")})]})})}),(0,r.jsx)("div",{className:"ml-4 mt-4 flex-shrink-0",children:t.from!==n&&(0,r.jsx)("button",{type:"button",onClick:function(){return function(){var e=t.data,n=e.id,r=e.name,i=e.type;l?(0,a.saveAs)(l,r):(0,s.X$)("file-download-request",{id:n,name:r,type:i})}()},className:"relative inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-500 hover:text-black",children:(0,r.jsx)(i.Z,{className:"h-6 w-6","aria-hidden":"true"})})})]})})}},40532:function(e,t,n){"use strict";var r=n(85893),i=n(67294),s=n(11355),a=n(82546),o=n(86588);t.Z=function(e){var t=e.open,n=e.setOpen,l=e.progress;e.error;return(0,r.jsx)(s.u.Root,{show:t,as:i.Fragment,children:(0,r.jsxs)(a.V,{as:"div",className:"relative z-10",onClose:n,children:[(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-25 transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsx)(a.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-gray-100",children:(0,r.jsx)(o.gy,{height:"40",width:"40",color:"#312e81",ariaLabel:"loading"})}),(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-5",children:[(0,r.jsx)(a.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Transferring file. Do not close."}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Peer to peer file transfer in progress. It make take some time for the recipient to receive the file (est. 1 min)."}),l>0&&(0,r.jsx)("div",{className:"flex items-center pt-2",children:(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full dark:bg-gray-700 mx-20",children:(0,r.jsxs)("div",{className:"bg-blue-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full",style:{width:"".concat(Math.floor(l),"%")},children:[" ",Math.floor(l),"%"]})})}),100===l&&(0,r.jsx)("div",{className:"mt-5 sm:mt-6",children:(0,r.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:text-sm",onClick:function(){return n(!1)},children:"File Transfer Complete!"})})]})]})]})})})})})]})})}},49332:function(e,t,n){"use strict";var r=n(67294);t.Z=function(e,t){(0,r.useEffect)((function(){if(e){e.style.height="40px",e.style.minHeight="40px";var t=e.scrollHeight;e.style.height=t+"px"}}),[e,t])}},45392:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var r=n(85893),i=n(67294),s=n(11355),a=n(82546),o=n(5506),l=function(){return(0,r.jsxs)("div",{className:"flex flex-row w-full h-full justify-between",children:[(0,r.jsx)("div",{})," ",(0,r.jsx)("div",{className:"flex justify-items-center",children:(0,r.jsx)("span",{className:"inline-flex items-center text-sm text-primary font-semibold font-medium",children:"Chat"})}),(0,r.jsx)("div",{})," "]})},c=n(30381),d=n.n(c),u=n(59758),f=n(6218),m=function(e){var t=e.myDid,n=e.messages,s=e.setHasUnreadVideoMessages,a=(0,i.useRef)(null),o=(0,f.ff)().data;(0,i.useEffect)((function(){var e;null===(e=a.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[n]),(0,i.useEffect)((function(){n.length&&s(!1)}),[n,s]);var l=function(e){var t=null===o||void 0===o?void 0:o.data.contacts.find((function(t){return t.did===e}));return t?"".concat(t.name,": "):""};return(0,r.jsxs)("div",{className:"flex flex-col w-full h-full overflow-y-auto",children:[n.map((function(e,n){return(0,r.jsx)("div",{children:"file-transfer-done"===e.type?(0,r.jsx)(u.Z,{message:e,myDid:t}):(0,r.jsx)("div",{className:"flex py-1 ".concat(e.from===t?"pl-4 flex-row-reverse":"pr-4"),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"px-4 py-2 rounded-lg inline-block rounded-br-none whitespace-pre-line ".concat(e.from===t?"bg-primary bg-opacity-10 text-primary text-sm":"bg-secondary text-white text-sm"),children:e.data}),(0,r.jsx)("div",{className:"flex ".concat(e.from===t&&"flex-row-reverse"),children:(0,r.jsx)("p",{className:"text-primary opacity-80 text-xs",children:"".concat(l(e.from)).concat(d()(e.timestamp).fromNow())})})]})},n)},n)})),(0,r.jsx)("div",{ref:a})]})},x=n(35666),h=n.n(x);var g=i.forwardRef((function(e,t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"}))})),p=n(40782),v=n(51079),y=n(45192),b=n(49332),j=n(72045),w=n(40532);function N(e,t,n,r,i,s,a){try{var o=e[s](a),l=o.value}catch(c){return void n(c)}o.done?t(l):Promise.resolve(l).then(r,i)}var k=function(e){var t=e.sendPeerMessage,n=e.peers,s=65535,a=(0,i.useState)(""),o=a[0],l=a[1],c=(0,i.useState)(),d=c[0],u=c[1],f=(0,i.useState)(1),m=f[0],x=f[1],k=(0,i.useState)(),C=k[0],E=k[1],M=(0,i.useState)(0),S=M[0],T=M[1],F=(0,i.useState)(s),O=F[0],Z=F[1],R=(0,i.useState)(0),B=R[0],V=R[1],P=(0,i.useState)(""),z=P[0],A=P[1],I=(0,i.useState)(0),L=I[0],_=I[1],K=(0,i.useState)(0),H=K[0],D=K[1],U=(0,i.useState)(!1),G=U[0],Y=U[1],$=(0,i.useRef)(null);(0,b.Z)($.current,o),(0,i.useEffect)((function(){L>0&&W(m)}),[C,B]);var X,J=(X=h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(),Y(!0),A((0,j.Z)()),e.next=5,d.arrayBuffer();case 5:t=e.sent,_(t.byteLength),n=t.byteLength%s==0?t.byteLength/s:Math.floor(t.byteLength/s)+1,D(n),E(t);case 10:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(n,r){var i=X.apply(e,t);function s(e){N(i,n,r,s,a,"next",e)}function a(e){N(i,n,r,s,a,"throw",e)}s(void 0)}))}),W=function(){if(x(m+1),m<=H){var e=C.slice(S,O);if(t({id:z,data:e},"file-transfer-chunk"),T(O),Z(O+s),m==H)console.log("Process is complete, counter",m),V(100),ee();else V(m/H*100)}},q=function(){V(0),x(1),T(0),Z(s)},Q=function(e){d&&te(),0!==n.length?(o.length>0&&t(o,"chat-message"),l("")):p.Am.error("Start a call with someone to use ephemeral chat.")},ee=function(){var e=d.name,n=d.type,r=d.size;console.log("File transfer is complete: ",d),t({name:e,type:n,size:r,id:z},"file-transfer-done"),u(),E(),Y(!1),V(0)},te=function(){J()};return(0,r.jsxs)(r.Fragment,{children:[d&&(0,r.jsx)(y.Z,{fileInput:d,setFileInput:u,progress:B}),(0,r.jsxs)("div",{className:"flex flex-row w-full items-end",children:[(0,r.jsx)("textarea",{type:"text",name:"message",id:"message",ref:$,className:"shadow-sm pl-2 pt-2 block w-full sm:text-sm border border-grey-100 rounded-md",placeholder:"Type message here ...",onKeyDown:function(e){e.shiftKey&&"Enter"===e.key?l("".concat(o)):"Enter"!==e.key||Q()},value:o,onChange:function(e){"\n"!==e.target.value&&l(e.target.value)}}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(v.Z,{setFile:u}),(0,r.jsx)("button",{type:"button",onClick:function(){return Q()},disabled:0===n.length,className:"mx-1",children:(0,r.jsx)(g,{className:"h-10 w-10 text-secondary","aria-hidden":"true"})})]}),(0,r.jsx)(w.Z,{open:G,setOpen:Y,progress:B})]})]})},C=n(91131),E=n(46249),M=n(82130),S=n(88247);function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){i=!0,s=l}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function F(e){var t=e.peers,n=e.openMessaging,c=e.toggleMessaging,d=e.id,u=(0,E.LU)().data,f=T((0,C.KO)(M.A2),1)[0],x=T((0,C.KO)(M.hi),2)[1],h=T((0,C.KO)(M.cN),2)[1];return(0,r.jsx)(s.u.Root,{show:n,as:i.Fragment,children:(0,r.jsx)(a.V,{as:"div",className:"fixed inset-0 overflow-hidden z-10",onClose:c,children:(0,r.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(a.V.Overlay,{className:"absolute inset-0 bg-gray-500 bg-opacity-10 transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-y-0 right-0 pl-10 max-w-full flex",children:(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,r.jsxs)("div",{className:"relative w-96 max-w-full",children:[(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"absolute top-0 left-0 -ml-8 pt-4 pr-2 flex sm:-ml-10 sm:pr-4",children:(0,r.jsxs)("button",{type:"button",className:"rounded-md text-gray-300 hover:text-white focus:outline-none focus:ring-2 focus:ring-white",onClick:function(){return c()},children:[(0,r.jsx)("span",{className:"sr-only",children:"Close panel"}),(0,r.jsx)(o.Z,{className:"h-6 w-6","aria-hidden":"true"})]})})}),(0,r.jsxs)("div",{className:"h-full flex flex-col bg-white shadow-xl overflow-y-scroll",children:[(0,r.jsx)("div",{className:"grow-0 px-4 py-6 bg-gray-50 sm:px-6",children:(0,r.jsx)(l,{})}),(0,r.jsx)("div",{className:"grow h-full px-4 overflow-hidden",children:(0,r.jsx)(m,{messages:f,myDid:null===u||void 0===u?void 0:u.id,setHasUnreadVideoMessages:h})}),(0,r.jsx)("div",{className:"grow-0 px-4 border-t border-gray-200 py-4 sm:px-6",children:(0,r.jsx)(k,{peers:t,sendPeerMessage:function(e,n){if("file-transfer-chunk"!==n){var r={data:e,timestamp:(new Date).toString(),from:u.id,networkId:d,type:n};"chat-message"!==n&&"file-transfer-done"!==n||x(r),t.map((function(e){e.peer.write(JSON.stringify(r))}))}else{var i="".concat(e.id,":").concat((0,S.c)(e.data));t.map((function(e){e.peer.write(i)}))}}})})]})]})})})]})})})}function O(e){var t=e.openParticipants,n=e.toggleParticipants,l=e.peers,c=(e.id,(0,i.useState)(!1)),d=(c[0],c[1]);return(0,r.jsx)(s.u.Root,{show:t,as:i.Fragment,children:(0,r.jsx)(a.V,{as:"div",className:"fixed inset-0 overflow-hidden",onClose:n,children:(0,r.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(a.V.Overlay,{className:"absolute inset-0 bg-gray-500 bg-opacity-0 transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-y-0 right-0 pl-10 max-w-full flex",children:(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,r.jsxs)("div",{className:"relative w-screen max-w-lg",children:[(0,r.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"absolute top-0 left-0 -ml-8 pt-4 pr-2 flex sm:-ml-10 sm:pr-4",children:(0,r.jsxs)("button",{type:"button",className:"rounded-md text-gray-300 hover:text-white focus:outline-none focus:ring-2 focus:ring-white",onClick:function(){return n()},children:[(0,r.jsx)("span",{className:"sr-only",children:"Close panel"}),(0,r.jsx)(o.Z,{className:"h-6 w-6","aria-hidden":"true"})]})})}),(0,r.jsxs)("div",{className:"h-full flex flex-col bg-white shadow-xl overflow-y-scroll",children:[(0,r.jsx)("div",{className:"grow-0 px-4 py-6 bg-gray-50 sm:px-6 flex justify-center",children:(0,r.jsx)("div",{className:"hidden sm:block flex space-x-4",children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("p",{className:"px-3 py-2 font-medium text-sm rounded-md",children:"Participants"})})})}),(0,r.jsx)("div",{className:"grow px-4 h-full",children:(0,r.jsx)("div",{className:"flow-root mt-6",children:(0,r.jsx)("ul",{className:"-my-5 divide-y divide-gray-200 px-5",children:l.map((function(e,t){return(0,r.jsx)("li",{className:"py-3",children:(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsx)("div",{className:"flex-1 min-w-0",children:(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.destDid})})})},t)}))})})}),(0,r.jsx)("div",{className:"grow-0 px-4 border-t border-gray-200 py-4 sm:px-6",children:(0,r.jsxs)("div",{className:"flex space-x-4 justify-center",children:[(0,r.jsx)("button",{type:"button",className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Mute All"}),(0,r.jsx)("button",{onClick:function(){return d(!0)},type:"button",className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Invite"})]})})]})]})})})]})})})}var Z=n(78757);var R=i.forwardRef((function(e,t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),i.createElement("path",{fillRule:"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z",clipRule:"evenodd"}))}));var B=i.forwardRef((function(e,t){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),i.createElement("path",{fillRule:"evenodd",d:"M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z",clipRule:"evenodd"}))})),V=n(63750),P=n(89583),z=n(64449),A=n(18426),I=n(19965),L=n(44156);function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){i=!0,s=l}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var K=function(e){var t=e.peer,n=(0,i.useRef)();return(0,i.useEffect)((function(){t.peer.on("stream",(function(e){n.current&&(n.current.srcObject=e)}))}),[t.peer]),(0,i.useEffect)((function(){t.peer._remoteStreams&&t.peer._remoteStreams.length>0&&(n.current.srcObject=t.peer._remoteStreams[0])}),[t.peer._remoteStreams]),(0,r.jsx)("div",{className:"flex justify-center bg-gray-100 rounded-lg m-2 px-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("video",{className:"h-full",playsInline:!0,ref:n,autoPlay:!0}),(0,r.jsx)("div",{className:"bg-gray-900 opacity-75 text-white rounded-md text-sm absolute bottom-0 left-0 px-4 m-2",children:t.metadata.contact.name})]})})},H=function(e){var t=e.toggleMessaging,n=e.peers,s=e.id,a=(0,i.useState)(!0),o=a[0],l=a[1],c=(0,i.useState)(!0),d=c[0],u=c[1],f=(0,i.useState)(!1),m=f[0],x=f[1],h=(0,i.useState)(!1),g=h[0],v=h[1],y=(0,i.useState)(!1),b=y[0],j=y[1],w=(0,i.useRef)(),N=_((0,C.KO)(M.g7),2),k=N[0],E=N[1],S=_((0,C.KO)(M.Vl),2),T=S[0],F=S[1],O=_((0,C.KO)(M.Uy),1)[0],H=_((0,C.KO)(M.cN),1)[0],D=(0,L.r)().data;(0,i.useEffect)((function(){G()}),[G]),(0,i.useEffect)((function(){0===n.length&&(null===k||void 0===k||k.getVideoTracks().forEach((function(e){e.enabled=!0})),l(!0),u(!0))}),[n,k]);var U,G=(0,i.useCallback)((function(){return new Promise((function(e,t){navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(t){w.current&&(w.current.srcObject=t),E(t),e(t)})).catch((function(e){console.log("Unable to capture video stream: ",e),p.Am.error("Unable to turn on audio and video. Please try again."),t(e)}))}))}),[E]),Y=function(){null===k||void 0===k||k.getTracks().forEach((function(e){e.stop()})),E(),w.current.srcObject=void 0},$=function(e){var t=e.getVideoTracks()[0];n.forEach((function(e){var n;(null===(n=e.peer._pc)||void 0===n?void 0:n.getSenders().find((function(e){return e.track.kind===t.kind}))).replaceTrack(t)})),x(!m)};return(0,r.jsxs)("div",{className:"bg-gray-50 w-full h-full flex items-center flex-col",children:[(0,r.jsx)("div",{className:"h-5/6 w-full pl-12 pr-12 mt-8",children:(0,r.jsxs)("div",{className:"grid w-full h-full ".concat((U=n.length,U<1?"":1===U?"grid-cols-2":U>1&&U<=3?"grid-cols-2 grid-rows-2":U>3&&U<=5?"grid-cols-3 grid-rows-2":U>5&&U<=7?"grid-cols-4 grid-rows-2":void 0)),children:[(0,r.jsx)("div",{className:"flex justify-center bg-gray-100 rounded-lg m-2 px-2 relative",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("video",{className:"h-full",playsInline:!0,muted:!0,ref:w,autoPlay:!0}),k&&(0,r.jsx)("div",{className:"bg-gray-900 opacity-75 text-white rounded-md text-sm absolute bottom-0 left-0 px-4 m-2",children:"You"})]})}),n.map((function(e,t){return(0,r.jsx)(K,{peer:e},t)}))]})}),(0,r.jsx)("div",{className:"absolute bottom-0 w-11/12 mb-4 px-6",children:(0,r.jsxs)("div",{className:"px-10 h-16 bg-black bg-opacity-40 inset-x-0 bottom-0 flex justify-between items-center rounded-lg",children:[(0,r.jsx)("div",{className:"flex space-x-4",children:(0,r.jsx)(r.Fragment,{children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{type:"button",onClick:function(){return n.forEach((function(e){e.peer.streams.length>0&&e.peer.streams.forEach((function(e){e.getAudioTracks().length>0&&e.getAudioTracks().forEach((function(e){e.enabled=!o}))}))})),void l(!o)},className:"flex flex-col items-center px-2 py-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[o?(0,r.jsx)(V.fr_,{className:"mb-2 h-6 w-6","aria-hidden":"true"}):(0,r.jsx)(V.$Jr,{className:"mb-2 h-6 w-6","aria-hidden":"true"}),o?"Mute":"Unmute"]}),(0,r.jsxs)("button",{type:"button",onClick:function(){return n.forEach((function(e){e.peer.streams.length>0&&e.peer.streams.forEach((function(e){e.getVideoTracks().length>0&&e.getVideoTracks().forEach((function(e){e.enabled=!d}))}))})),void u(!d)},className:"flex flex-col items-center px-2 py-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[d?(0,r.jsx)(P.KoQ,{className:"mb-2 h-6 w-6","aria-hidden":"true"}):(0,r.jsx)(P.uCi,{className:"mb-2 h-6 w-6","aria-hidden":"true"}),d?"Stop Video":"Start Video"]}),0===n.length&&(0,r.jsxs)("button",{type:"button",onClick:function(){return Y()},className:"flex flex-col items-center px-2 py-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[(0,r.jsx)(I.Z,{className:"mb-2 h-6 w-6","aria-hidden":"true"}),"Disconnect A/V"]})]}):(0,r.jsx)(r.Fragment,{children:0===n.length&&(0,r.jsx)("button",{type:"button",onClick:function(){return G()},className:"flex flex-col items-center px-2 py-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:"Connect Audio & Video"})})})}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("button",{onClick:function(){if(!k)return v(!0),void(0,p.Am)((function(e){var t=e.closeToast;return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"pb-1",children:"Turn on camera and microphone?"}),(0,r.jsxs)("p",{className:"text-xs pb-2",children:["Do you want to turn on camera and microphone? This is a chat-only invitation."," "]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{type:"button",onClick:function(){G(),v(!0),t()},className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Connect Audio/Video"}),(0,r.jsx)("button",{type:"button",onClick:function(){t(),v(!0)},className:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Continue"})]})]})}),{autoClose:!1});v(!0)},type:"button",className:"flex flex-col items-center px-2 py-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[(0,r.jsx)(Z.Z,{className:"mb-2 h-6 w-6","aria-hidden":"true"}),n.length?"Participants (".concat(n.length,")"):"Participants"]}),(0,r.jsxs)("div",{className:"flex items-center px-6 py-2 ",children:[H&&(0,r.jsx)("div",{className:"bg-red-500 flex-shrink-0 w-3 h-3 rounded-full","aria-hidden":"true"}),(0,r.jsxs)("button",{onClick:function(){return t()},type:"button",className:"flex flex-col items-center px-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[(0,r.jsx)(R,{className:"mb-2 h-6 w-6","aria-hidden":"true"}),"Chat"]})]}),(0,r.jsx)("div",{className:"flex items-center px-6 py-2 ",children:(0,r.jsxs)("button",{onClick:function(){return console.log(k.getVideoTracks()[0]),void(m?navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){w.current&&(w.current.srcObject=e),E(e),$(e)})):navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0,cursor:!0}).then((function(e){w.current&&(w.current.srcObject=e),E(e),$(e)})))},type:"button",className:"flex flex-col items-center px-2 text-sm leading-4 font-medium rounded-md text-green-400 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[(0,r.jsx)(B,{className:"mb-2 h-6 w-6","aria-hidden":"true"}),m?"Stop Screen Share":"Share Screen"]})}),(0,r.jsxs)("button",{type:"button",onClick:function(){(null===D||void 0===D?void 0:D.data.lightningConfig.listening)?j(!0):p.Am.info("Connect to a lightning node to use this action.")},className:"flex flex-col items-center px-4 py-2 text-sm leading-4 font-medium rounded-md text-gray-50 bg-opacity-100 hover:bg-opacity-20 hover:bg-gray-100",children:[(0,r.jsx)(V.mly,{className:"mb-2 h-6 w-6 text-yellow-400","aria-hidden":"true"}),"Send/Receive"]})]}),(0,r.jsx)("div",{className:"flex space-x-4",children:(0,r.jsx)("button",{type:"button",onClick:function(){return Y(),F(T.filter((function(e){return e.networkId!==O}))),void n.forEach((function(e){e.peer.destroy()}))},className:"inline-flex items-center px-8 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-200",children:"End"})}),(0,r.jsx)(A.Z,{open:b,setOpen:j,selectedContact:null}),(0,r.jsx)(z.Z,{open:g,setOpen:v,networkId:s,localStream:k||!1,title:"Invite Users to Meeting",subtitle:"Invite people to join this meeting.",type:"video-call-invitation"})]})})]})},D=n(60758);function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){i=!0,s=l}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var G=function(){var e=function(){return a(!s)},t=function(){return c(!l)},n=(0,i.useState)(!1),s=n[0],a=n[1],o=(0,i.useState)(!1),l=o[0],c=o[1],d=U((0,C.KO)(M.Uy),2),u=d[0],f=d[1],m=U((0,C.KO)(M.C3),1)[0];return(0,i.useEffect)((function(){if(!u){console.log("Creating a new meeting room.");var e=(0,j.Z)();f(e)}}),[u,f]),(0,r.jsxs)(D.Z,{currentPage:"Meeting",hideNav:!0,children:[(0,r.jsx)(H,{peers:m,id:u,toggleParticipants:t,toggleMessaging:e}),(0,r.jsx)(F,{peers:m,id:u,openMessaging:s,toggleMessaging:e}),(0,r.jsx)(O,{peers:m,id:u,openParticipants:l,toggleParticipants:t})]})}},13902:function(e,t,n){"use strict";var r=n(67294);const i=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}));t.Z=i},19965:function(e,t,n){"use strict";var r=n(67294);const i=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}))}));t.Z=i},42833:function(e,t,n){"use strict";var r=n(67294);const i=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"}))}));t.Z=i},42633:function(e,t,n){"use strict";var r=n(67294);const i=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"}))}));t.Z=i},78757:function(e,t,n){"use strict";var r=n(67294);const i=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"}))}));t.Z=i},68163:function(e,t,n){"use strict";var r=n(67294);const i=r.forwardRef((function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"}))}));t.Z=i},47941:function(e,t,n){"use strict";n.d(t,{G:function(){return u}});const r="bits",i="bytes",s="",a="iec",o="jedec",l="round",c="string",d={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function u(e,{bits:t=!1,pad:n=!1,base:u=-1,round:f=2,locale:m="",localeOptions:x={},separator:h="",spacer:g=" ",symbols:p={},standard:v="",output:y=c,fullform:b=!1,fullforms:j=[],exponent:w=-1,roundingMethod:N=l,precision:k=0}={}){let C=w,E=Number(e),M=[],S=0,T=s;-1===u&&0===v.length?(u=10,v=o):-1===u&&v.length>0?u=(v=v===a?a:o)===a?2:10:v=10===(u=2===u?2:10)||v===o?o:a;const F=10===u?1e3:1024,O=!0===b,Z=E<0,R=Math[N];if("bigint"!==typeof e&&isNaN(e))throw new TypeError("Invalid number");if("function"!==typeof R)throw new TypeError("Invalid rounding method");if(Z&&(E=-E),(-1===C||isNaN(C))&&(C=Math.floor(Math.log(E)/Math.log(F)),C<0&&(C=0)),C>8&&(k>0&&(k+=8-C),C=8),"exponent"===y)return C;if(0===E)M[0]=0,T=M[1]=d.symbol[v][t?r:i][C];else{S=E/(2===u?Math.pow(2,10*C):Math.pow(1e3,C)),t&&(S*=8,S>=F&&C<8&&(S/=F,C++));const e=Math.pow(10,C>0?f:0);M[0]=R(S*e)/e,M[0]===F&&C<8&&-1===w&&(M[0]=1,C++),T=M[1]=10===u&&1===C?t?"kbit":"kB":d.symbol[v][t?r:i][C]}if(Z&&(M[0]=-M[0]),k>0&&(M[0]=M[0].toPrecision(k)),M[1]=p[M[1]]||M[1],!0===m?M[0]=M[0].toLocaleString():m.length>0?M[0]=M[0].toLocaleString(m,x):h.length>0&&(M[0]=M[0].toString().replace(".",h)),n&&!1===Number.isInteger(M[0])&&f>0){const e=h||".",t=M[0].toString().split(e),n=t[1]||s,r=n.length,i=f-r;M[0]=`${t[0]}${e}${n.padEnd(r+i,"0")}`}return O&&(M[1]=j[C]?j[C]:d.fullform[v][C]+(t?"bit":"byte")+(1===M[0]?s:"s")),"array"===y?M:"object"===y?{value:M[0],symbol:M[1],exponent:C,unit:T}:M.join(g)}}},function(e){e.O(0,[774,445,13,270,500,758,449,888,179],(function(){return t=7309,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[449],{64449:function(e,t,n){n.d(t,{Z:function(){return N}});var r=n(85893),i=n(67294),a=n(11355),s=n(82546),o=n(5506),l=n(91131),d=n(82130),c=n(43101),u=n(59856),m=n(46249),x=n(6218),f=n(61751),h=n(40782),v=n(63090),p=n(85528);function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(l){i=!0,a=l}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function j(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}var b=function(e){var t=e.selected,n=e.setSelected,i=e.peers,a=e.networkId,s=(0,x.ff)().data,o=(0,x.JA)().data,c=g((0,l.KO)(d.kH),2)[1],u=function(e){return t.includes(e)},m=function(e){return u(e)?n((function(){return t.filter((function(t){return t!==e}))})):n((function(t){return y(t).concat([e])}))},f=function(e){return i.find((function(t){var n;return(null===(n=t.metadata.contact)||void 0===n?void 0:n.did)===(null===e||void 0===e?void 0:e.did)&&t.metadata.networkId===a}))},v=function(e){var t,n=f(e);return!!n&&"open"===(null===(t=n.peer._channel)||void 0===t?void 0:t.readyState)},j=function(e){var t,n=f(e);return!!n&&"connecting"===(null===(t=n.peer._channel)||void 0===t?void 0:t.readyState)},b=function(e){return v(e)?"Connected":j(e)?"Invited":void 0};return(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"flow-root mt-6",children:(0,r.jsx)("ul",{role:"list",className:"-my-5 divide-y divide-gray-200",children:null===s||void 0===s?void 0:s.data.contacts.map((function(e,t){return(0,r.jsx)("li",{className:"py-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(p.Z,{contact:e,className:"h-8 w-8"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 truncate",children:b(e)})]}),(null===o||void 0===o?void 0:o.includes(e.did))?(0,r.jsx)("span",{className:"ml-2 inline-flex items-center rounded-md bg-red-100 px-2.5 py-0.5 text-sm font-medium text-red-800",children:"Blocked"}):(0,r.jsx)(r.Fragment,{children:!v(e)&&(0,r.jsx)("div",{children:j(e)?(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{onClick:function(){return function(e){var t=f(e);t&&c(t),m(e)}(e)},className:"inline-flex items-center shadow-sm px-2.5 py-0.5 border border-gray-300 text-sm leading-5 font-medium rounded-full text-gray-700 bg-white hover:bg-gray-50",children:"Try Again"}),(0,r.jsx)("button",{onClick:function(){return function(e){var t=f(e);t?(c(t),h.Am.success("Invitation revoked.")):console.error("Error: Unable to find matching peer.")}(e)},className:"inline-flex items-center shadow-sm px-2.5 py-0.5 border border-red-300 text-sm leading-5 font-medium rounded-full text-red-700 bg-white hover:bg-red-50",children:"Remove"})]}):(0,r.jsx)("button",{onClick:function(){return m(e)},className:"inline-flex items-center shadow-sm px-2.5 py-0.5 border border-gray-300 text-sm leading-5 font-medium rounded-full text-gray-700 bg-white hover:bg-gray-50",children:u(e)?"Undo":"Invite"})})})]})},e.did)}))})})})},w=function(e){var t=e.peers;return(0,r.jsx)("div",{children:(0,r.jsx)("ul",{role:"list",className:"mt-2 divide-y divide-gray-200 px-4",children:t.map((function(e,t){return(0,r.jsxs)("li",{className:"flex items-center justify-between py-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(p.Z,{contact:e.metadata.contact,className:"h-8 w-8"}),(0,r.jsx)("p",{className:"ml-4 text-sm font-medium text-gray-900",children:e.metadata.contact.name})]}),(0,r.jsxs)("div",{className:"ml-6 text-sm font-medium text-gray-700",children:["open"===e.peer._channel.readyState?"Connected":"Invited",(0,r.jsxs)("span",{className:"sr-only",children:[" ",e.metadata.contact.name]})]})]},t)}))})})};function N(e){var t=e.open,n=e.setOpen,x=e.networkId,p=e.type,y=e.localStream,N=e.title,k=e.subtitle,C=(0,i.useState)([]),I=C[0],A=C[1],S=(0,i.useState)(!1),F=S[0],O=S[1],T=g((0,l.KO)(d.fo),2)[1],E=g((0,l.KO)(d.C3),1)[0],_=g((0,l.KO)(d.uy),1)[0],K=g((0,l.KO)(c.r2),1)[0],V=(0,m.LU)().data,Z=(0,f.$3)().mutate,B=function(e){return"video-call-invitation"===e?E:"doc-collab-request"===e?_:void 0};return(0,r.jsx)(a.u.Root,{show:t,as:i.Fragment,children:(0,r.jsx)(s.V,{as:"div",className:"fixed inset-0 overflow-hidden z-10",onClose:n,children:(0,r.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,r.jsx)(a.u.Child,{as:i.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(s.V.Overlay,{className:"absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,r.jsx)("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,r.jsx)(a.u.Child,{as:i.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,r.jsx)("div",{className:"pointer-events-auto relative w-96",children:(0,r.jsx)(a.u.Child,{as:i.Fragment,enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsxs)("div",{className:"h-full grid grid-rows-6 grid-cols-1",children:[(0,r.jsxs)("div",{className:"bg-primary py-8 px-4 sm:px-6 row-span-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(s.V.Title,{className:"text-lg font-medium text-white",children:[" ",N," "]}),(0,r.jsx)("div",{className:"ml-3 flex h-7 items-center",children:(0,r.jsxs)("button",{type:"button",className:"rounded-md bg-primary text-indigo-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-white",onClick:function(){return n(!1)},children:[(0,r.jsx)("span",{className:"sr-only",children:"Close panel"}),(0,r.jsx)(o.Z,{className:"h-6 w-6","aria-hidden":"true"})]})})]}),(0,r.jsxs)("div",{className:"mt-1",children:[(0,r.jsx)("p",{className:"text-sm text-indigo-300 pb-2",children:k}),(0,r.jsxs)("p",{className:"text-sm text-indigo-300",children:["ID: ",x]})]})]}),(0,r.jsxs)("div",{className:"row-span-5 flex flex-col bg-white",children:[(0,r.jsx)("div",{className:"grow-0 px-4 py-4 sm:px-6",children:(0,r.jsxs)("div",{className:"flex justify-center items-center space-x-6",children:[(0,r.jsx)("button",{className:j(F?"text-gray-500 hover:text-gray-700":"bg-indigo-100 text-indigo-700","px-3 py-2 font-medium text-sm rounded-md"),onClick:function(){return O(!1)},children:"Invite"}),(0,r.jsx)("button",{className:j(F?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700","px-3 py-2 font-medium text-sm rounded-md"),onClick:function(){return O(!0)},children:"Participants"})]})}),(0,r.jsx)("div",{className:"grow h-full max-h-full overflow-y-auto px-4",children:F?(0,r.jsx)(w,{peers:B(p)}):(0,r.jsx)(b,{selected:I,setSelected:A,peers:B(p),networkId:x})}),I.length>0&&(0,r.jsx)("div",{className:"grow-0 px-4 py-4 sm:px-6",children:(0,r.jsxs)("button",{type:"button",onClick:function(){return function(){var e=x||currentVideoCallId,t=B(p);I.forEach((function(n){var r=t.find((function(t){return t.metadata.dest===n.did&&t.metadata.networkId===e}));if(r)console.log("A duplicate peer already exist on the network...skipping.");else{var i=t.map((function(e){return e.metadata})),a=(0,u.aH)({networkId:e,networkOwner:V.id,sendBasicMessage:Z,lightningEnabled:K,src:V.id,contact:n,type:p,localStream:y,currentPeer:r,existingNetworkPeers:i});T(a)}})),A([]),h.Am.info("Invitations sent!"),"doc-collab-request"===p&&(0,v.X$)("save-draft-local-state")}()},className:"w-full flex-1 rounded-md border border-transparent bg-primary py-3 px-3 text-md font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:["Send Invites (",I.length,")"]})})]})]})})})})})]})})})}}}]);
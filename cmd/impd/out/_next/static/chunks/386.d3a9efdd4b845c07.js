!function(){function n(n){return function(n){if(Array.isArray(n)){for(var r=0,e=new Array(n.length);r<n.length;r++)e[r]=n[r];return e}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var r=[];self.addEventListener("message",(function(e){var o=e.data,t=o.name,i=o.type,a=o.id,f=o.action,d=o.chunk,l=o.did,c=o.from;if(f){if("download"===f){console.log("prepping file for download: ",a);var u=r.find((function(n){return n.id===a}));if(!u)return void console.log("File is unavailable for download: ",a);var s=new Blob(u.chunks,{type:i}),p=new File([s],t,{type:i});self.postMessage({id:a,file:p,did:l,from:c})}"abort"===f&&(console.log("abording file transfer"),r=[])}else{var g=r.find((function(n){return n.id===a}));if(g)return g.chunks.push(d),void(r=r.map((function(n){return n.id===g.id?g:n})));r=n(r).concat([{id:a,chunks:[d]}])}})),_N_E={}}();